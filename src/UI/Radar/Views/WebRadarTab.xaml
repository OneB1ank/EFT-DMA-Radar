<UserControl x:Class="LoneEftDmaRadar.UI.Radar.Views.WebRadarTab"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:LoneEftDmaRadar.UI.Radar.ViewModels"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:LoneEftDmaRadar.UI.Radar.Views"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             Padding="10">

    <d:UserControl.DataContext>
        <d:DesignInstance Type="{x:Type vm:WebRadarViewModel}"
                          IsDesignTimeCreatable="False" />
    </d:UserControl.DataContext>

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Orientation="Vertical"
                    Margin="0,0,0,10">

            <!-- Web Radar Server -->
            <GroupBox Header="网页雷达 服务器"
                      Margin="0,0,0,12">
                <StackPanel>

                    <!-- Controls row  -->
                    <WrapPanel Margin="0,8,0,8">

                        <!-- Start -->
                        <Button Content="{Binding StartButtonText}"
                                IsEnabled="{Binding UiEnabled}"
                                ToolTip="启动内嵌的 Web 服务器。"
                                Command="{Binding StartServerCommand}"
                                MinWidth="80"
                                Height="35"
                                Margin="8,0,12,8" />

                        <!-- UPnP -->
                        <CheckBox Content="UPnP"
                                  IsEnabled="{Binding UiEnabled}"
                                  ToolTip="使用 UPnP（如果支持）自动在路由器上打开端口。"
                                  IsChecked="{Binding UpnpEnabled, Mode=TwoWay}"
                                  Margin="0,0,16,8" />

                        <!-- Bind IP/Host -->
                        <TextBlock Text="绑定 IP/主机"
                                   VerticalAlignment="Center"
                                   Margin="0,0,4,8"
                                   ToolTip="要绑定的接口或主机名。使用 0.0.0.0 在所有接口上监听。" />
                        <TextBox Width="150"
                                 Margin="0,0,12,8"
                                 ToolTip="要绑定的接口或主机名。使用 0.0.0.0 在所有接口上监听。"
                                 IsEnabled="{Binding UiEnabled}"
                                 Text="{Binding BindAddress, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                        <!-- Port -->
                        <TextBlock Text="端口"
                                   ToolTip="监听的 TCP 端口。需要在路由器中转发，或通过 UPnP。"
                                   VerticalAlignment="Center"
                                   Margin="0,0,4,8" />
                        <TextBox Width="80"
                                 Margin="0,0,12,8"
                                 ToolTip="监听的 TCP 端口。需要在路由器中转发，或通过 UPnP。"
                                 IsEnabled="{Binding UiEnabled}"
                                 Text="{Binding Port, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                        <!-- Tick Rate -->
                        <TextBlock Text="更新频率 (hz)"
                                   ToolTip="网页雷达更新的广播速率（每秒）。"
                                   VerticalAlignment="Center"
                                   Margin="0,0,4,8" />
                        <TextBox Width="80"
                                 ToolTip="网页雷达更新的广播速率（每秒）。"
                                 Margin="0,0,12,8"
                                 IsEnabled="{Binding UiEnabled}"
                                 Text="{Binding TickRate, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                        <!-- Password -->
                        <TextBlock Text="密码"
                                   VerticalAlignment="Center"
                                   ToolTip="客户端需要的密码。"
                                   Margin="0,0,4,8" />
                        <TextBox Width="140"
                                 IsReadOnly="True"
                                 Margin="0,0,12,8"
                                 ToolTip="客户端需要的密码。"
                                 IsEnabled="{Binding UiEnabled}"
                                 Text="{Binding Password, Mode=OneWay, UpdateSourceTrigger=Default}" />

                        <!-- URL (clickable + actions) -->
                        <TextBlock VerticalAlignment="Center"
                                   Margin="0,0,6,8">
                            <Hyperlink Command="{Binding CopyUrlCommand}"
                                       ToolTip="将网页雷达 URL 复制到剪贴板。">
                                <Run Text="{Binding ServerUrl}" />
                            </Hyperlink>
                        </TextBlock>
                    </WrapPanel>
                    
                    <!-- Help text -->
                    <TextBlock TextWrapping="Wrap"
                               Margin="4,4,4,8">
                        如果绑定 IP/主机为空，服务器将无法启动。使用 0.0.0.0 在局域网中公开。<LineBreak />
                        在路由器上保持端口打开。UPnP 会在可用时尝试创建路由映射。<LineBreak />
                        如果您的朋友使用 https 连接网页雷达，他们需要在浏览器中允许混合内容（http/https）。建议仅使用 HTTP 连接。
                    </TextBlock>
                </StackPanel>
            </GroupBox>

        </StackPanel>
    </ScrollViewer>
</UserControl>
